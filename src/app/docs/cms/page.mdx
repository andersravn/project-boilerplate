import { CodeBlock, ComponentPreview } from '@/components/docs/documentation-components';
import { Alert, Badge } from '@/components/docs/ui-helpers';

# CMS Integration Guide

This boilerplate includes support for multiple CMS systems. You can remove the integrations you don't need.

## Supported CMS Systems

<div className="grid gap-4 md:grid-cols-2 mb-6">
  <div className="border rounded-lg p-4">
    <div className="flex items-center gap-2 mb-2">
      <h3 className="text-lg font-semibold">Uniform</h3>
      <Badge variant="success">Included</Badge>
    </div>
    <div className="text-sm text-muted-foreground">
      Visual CMS with Next.js App Router support and component mapping.
    </div>
  </div>
  
  <div className="border rounded-lg p-4">
    <div className="flex items-center gap-2 mb-2">
      <h3 className="text-lg font-semibold">Contentful</h3>
      <Badge variant="secondary">Planned</Badge>
    </div>
    <div className="text-sm text-muted-foreground">
      Headless CMS with GraphQL API and rich content modeling.
    </div>
  </div>
</div>

## Uniform Setup

The project includes boilerplate code for Uniform CMS integration:

### 1. Environment Variables

<CodeBlock filename=".env.local">
{`# Uniform Configuration
UNIFORM_API_KEY=your_api_key_here
UNIFORM_PROJECT_ID=your_project_id_here
UNIFORM_PREVIEW_SECRET=your_preview_secret_here`}
</CodeBlock>

### 2. Project Structure

The Uniform integration is organized as follows:

<CodeBlock language="text">
{`src/
├── app/uniform/
│   └── [[...path]]/
│       └── page.tsx          # Catch-all route for CMS pages
├── uniform/
│   ├── canvas/
│   │   ├── Container.tsx     # Layout component
│   │   ├── Hero.tsx         # Hero section component
│   │   └── index.ts         # Component registry
│   └── utils/
│       └── routing.ts       # Uniform routing utilities
└── types/
    └── cskTypes.ts          # TypeScript definitions`}
</CodeBlock>

### 3. Component Mapping

Register your UI components for use in Uniform:

<CodeBlock filename="src/uniform/canvas/index.ts">
{`import { ComponentInstance } from '@uniformdev/canvas';
import { Hero } from './Hero';
import { Container } from './Container';
import Button from '@/components/ui/button';

export const componentMap = {
  hero: Hero,
  container: Container,
  button: Button,
  // Add your components here
};

export type ComponentProps<T = ComponentInstance> = {
  component: T;
};`}
</CodeBlock>

### 4. Creating CMS Components

Wrap your UI components for CMS use:

<CodeBlock filename="src/uniform/canvas/Hero.tsx">
{`import { ComponentProps } from './index';
import Button from '@/components/ui/button';

export function Hero({ component }: ComponentProps) {
  const { title, subtitle, ctaText, ctaLink } = component.parameters || {};

  return (
    <section className="py-24 px-4">
      <div className="container mx-auto text-center">
        <h1 className="text-4xl font-bold mb-4">
          {title?.value || 'Default Title'}
        </h1>
        <p className="text-xl text-muted-foreground mb-8">
          {subtitle?.value || 'Default subtitle'}
        </p>
        {ctaText?.value && (
          <Button asChild>
            <a href={ctaLink?.value || '#'}>
              {ctaText.value}
            </a>
          </Button>
        )}
      </div>
    </section>
  );
}`}
</CodeBlock>

## Removing CMS Code

If you don't need CMS integration, you can safely remove:

<Alert variant="warning" title="Cleanup Steps">
  <ol className="list-decimal list-inside space-y-1">
    <li>Delete the `src/app/uniform/` directory</li>
    <li>Delete the `src/uniform/` directory</li>
    <li>Remove Uniform dependencies from package.json</li>
    <li>Remove environment variables</li>
    <li>Delete `uniform.server.config.js`</li>
  </ol>
</Alert>

### Dependencies to Remove

<CodeBlock language="bash">
{`npm uninstall @uniformdev/canvas-next-rsc`}
</CodeBlock>

## Adding Other CMS Systems

To add support for another CMS:

1. **Create a new app route**: `src/app/[cms-name]/[[...path]]/page.tsx`
2. **Install CMS SDK**: Add the necessary packages
3. **Create component wrappers**: Map your UI components to CMS components
4. **Configure routing**: Set up catch-all routes and data fetching
5. **Add environment variables**: Configure API keys and settings

### Example: Adding Contentful

<CodeBlock filename="src/app/contentful/[[...path]]/page.tsx">
{`import { createClient } from 'contentful';
import { ComponentRenderer } from '@/components/contentful/ComponentRenderer';

const client = createClient({
  space: process.env.CONTENTFUL_SPACE_ID!,
  accessToken: process.env.CONTENTFUL_ACCESS_TOKEN!,
});

export default async function ContentfulPage({ 
  params 
}: { 
  params: { path: string[] } 
}) {
  const slug = params.path?.join('/') || 'home';
  
  const entries = await client.getEntries({
    content_type: 'page',
    'fields.slug': slug,
  });
  
  const page = entries.items[0];
  
  if (!page) {
    return <div>Page not found</div>;
  }
  
  return <ComponentRenderer page={page} />;
}`}
</CodeBlock>

## Best Practices

<Alert title="CMS Integration Tips">
  <ul className="list-disc list-inside space-y-1">
    <li>Keep UI components separate from CMS logic</li>
    <li>Use TypeScript for CMS data structures</li>
    <li>Implement proper error handling for missing content</li>
    <li>Add preview modes for content editors</li>
    <li>Use environment variables for all CMS configuration</li>
  </ul>
</Alert>
