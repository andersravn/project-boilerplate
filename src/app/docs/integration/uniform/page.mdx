import { CodeBlock, ComponentPreview } from '@/components/docs/documentation-components';
import { Alert, Badge } from '@/components/docs/ui-helpers';

# Uniform Integration

Complete setup guide for Uniform CMS integration with visual editing and component mapping.

## Setup

### 1. Environment Variables

<CodeBlock filename=".env.local">
{`# Uniform Configuration
UNIFORM_API_KEY=your_api_key_here
UNIFORM_PROJECT_ID=your_project_id_here
UNIFORM_PREVIEW_SECRET=your_preview_secret_here`}
</CodeBlock>

### 2. Project Structure

The Uniform integration is organized as follows:

<CodeBlock language="text">
{`src/
â”œâ”€â”€ app/uniform/
â”‚   â””â”€â”€ [[...path]]/
â”‚       â””â”€â”€ page.tsx          # Catch-all route for CMS pages
â”œâ”€â”€ uniform/
â”‚   â”œâ”€â”€ canvas/
â”‚   â”‚   â”œâ”€â”€ Container.tsx     # Layout component
â”‚   â”‚   â”œâ”€â”€ Hero.tsx         # Hero section component
â”‚   â”‚   â””â”€â”€ index.ts         # Component registry
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ routing.ts       # Uniform routing utilities
â””â”€â”€ types/
    â””â”€â”€ cskTypes.ts          # TypeScript definitions`}
</CodeBlock>

### 3. Component Mapping

Register your UI components for use in Uniform:

<CodeBlock filename="src/uniform/canvas/index.ts">
{`import { ComponentInstance } from '@uniformdev/canvas';
import { Hero } from './Hero';
import { Container } from './Container';
import Button from '@/components/ui/button';

export const componentMap = {
  hero: Hero,
  container: Container,
  button: Button,
  // Add your components here
};

export type ComponentProps<T = ComponentInstance> = {
  component: T;
};`}
</CodeBlock>

### 4. Creating CMS Components

Wrap your UI components for CMS use:

<CodeBlock filename="src/uniform/canvas/Hero.tsx">
{`import { ComponentProps } from './index';
import Button from '@/components/ui/button';

export function Hero({ component }: ComponentProps) {
  const { title, subtitle, ctaText, ctaLink } = component.parameters || {};

  return (
    <section className="py-24 px-4">
      <div className="container mx-auto text-center">
        <h1 className="text-4xl font-bold mb-4">
          {title?.value || 'Default Title'}
        </h1>
        <p className="text-xl text-muted-foreground mb-8">
          {subtitle?.value || 'Default subtitle'}
        </p>
        {ctaText?.value && (
          <Button asChild>
            <a href={ctaLink?.value || '#'}>
              {ctaText.value}
            </a>
          </Button>
        )}
      </div>
    </section>
  );
}`}
</CodeBlock>

## Webhooks & Deployment

<Alert title="Production Setup">
  When deploying to production, configure webhooks for automatic content updates:
  
  <a href="https://docs.uniform.app/docs/learn/tutorials/nextjs-app-router#3-2-configure-webhooks" className="text-primary hover:underline">
    Uniform Webhook Documentation â†’
  </a>
</Alert>

## Removing Uniform

If you don't need Uniform integration, you can safely remove:

<Alert variant="warning" title="Cleanup Steps">
  <ol className="list-decimal list-inside space-y-1">
    <li>Delete the `src/app/uniform/` directory</li>
    <li>Delete the `src/uniform/` directory</li>
    <li>Remove Uniform dependencies from package.json</li>
    <li>Remove environment variables</li>
    <li>Delete `uniform.server.config.js`</li>
  </ol>
</Alert>

### Dependencies to Remove

<CodeBlock language="bash">
{`npm uninstall @uniformdev/canvas-next-rsc`}
</CodeBlock>

## Resources

- ðŸ“š [Uniform Documentation](https://docs.uniform.app/)
- ðŸŽ¯ [Next.js App Router Tutorial](https://docs.uniform.app/docs/learn/tutorials/nextjs-app-router)
- ðŸ”§ [Component Development Guide](https://docs.uniform.app/docs/guides/composition/canvas-components)
